***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/Caption_distill_double/rn50_nuswide.yaml
dataset_config_file: configs/datasets/nuswide_distill_limit.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['TRAINER.Caption.N_CTX', '16', 'TRAINER.Caption.CSC', 'False', 'TRAINER.Caption.CLASS_TOKEN_POSITION', 'end']
output_dir: output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3
resume: 
root: /media/data2/MLICdataset/
seed: 3
source_domains: None
target_domains: None
trainer: Caption_distill_double
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 512
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: nuswide_distill_limit
  NUM_LABELED: -1
  NUM_SHOTS: -1
  ROOT: /media/data2/MLICdataset/
  SAMPLE: 0
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
  partial_prob: 0.5
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
  TRANSFORMS_TEST: ('resize', 'center_crop', 'normalize')
  cutout_proportion: 0.4
  random_resized_crop_scale: (0.6, 1.0)
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.001
  LR_SCHEDULER: cosine
  MAX_EPOCH: 20
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: MLClassification
  EVALUATOR_ACT: default_merge_aux
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SAVE_PREDS: 
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  Caption_num: 0
  IF_LEARN_SCALE: False
  IF_LEARN_spatial_SCALE: False
  IF_ablation: False
  LOSSFUNC: double_ranking
  PRINT_FREQ: 5
  spatial_SCALE_image: 4
  spatial_SCALE_text: 50
TRAINER:
  CG:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  Caption:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    GL_merge_rate: 0.5
    N_CTX: 16
    PREC: fp32
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEA:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: Caption_distill_double
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.3
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.5 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: 10.0.0-4ubuntu1 
CMake version: version 3.16.3
Libc version: glibc-2.31

Python version: 3.9.0 | packaged by conda-forge | (default, Oct 14 2020, 22:59:50)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.15.0-58-generic-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.8.89
GPU models and configuration: 
GPU 0: NVIDIA GeForce RTX 3090
GPU 1: NVIDIA GeForce RTX 3090

Nvidia driver version: 520.61.05
cuDNN version: Probably one of the following:
/usr/lib/x86_64-linux-gnu/libcudnn.so.8.6.0
/usr/lib/x86_64-linux-gnu/libcudnn_adv_infer.so.8.6.0
/usr/lib/x86_64-linux-gnu/libcudnn_adv_train.so.8.6.0
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_infer.so.8.6.0
/usr/lib/x86_64-linux-gnu/libcudnn_cnn_train.so.8.6.0
/usr/lib/x86_64-linux-gnu/libcudnn_ops_infer.so.8.6.0
/usr/lib/x86_64-linux-gnu/libcudnn_ops_train.so.8.6.0
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.2
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-spline-conv==1.2.1
[pip3] torchaudio==0.11.0
[pip3] torchvision==0.12.0
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.3.1               h2bc3f7f_2  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py39h7f8727e_0  
[conda] mkl_fft                   1.3.1            py39hd3c417c_0  
[conda] mkl_random                1.2.2            py39h51133e4_0  
[conda] numpy                     1.21.2           py39h20f2e39_0  
[conda] numpy-base                1.21.2           py39h79a1101_0  
[conda] pyg                       2.0.4           py39_torch_1.11.0_cu113    pyg
[conda] pytorch                   1.11.0          py3.9_cuda11.3_cudnn8.2.0_0    pytorch
[conda] pytorch-cluster           1.6.0           py39_torch_1.11.0_cu113    pyg
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] pytorch-scatter           2.0.9           py39_torch_1.11.0_cu113    pyg
[conda] pytorch-sparse            0.6.13          py39_torch_1.11.0_cu113    pyg
[conda] pytorch-spline-conv       1.2.1           py39_torch_1.11.0_cu113    pyg
[conda] torchaudio                0.11.0               py39_cu113    pytorch
[conda] torchvision               0.12.0               py39_cu113    pytorch
        Pillow (9.0.1)

Loading trainer: Caption_distill_double
Loading dataset: nuswide_distill_limit
NUS-WIDE total 161789 images, test 107859 images. 
torch.Size([507444, 77])
class caption num:
 tensor([   369,   5814,   1162,    580,   8186,   8698,  14835,   6125,  92387,
         22791,    338,   3823,   3008,  22837,  10563,    157,    370,   1671,
          7646,     12,    309,   1665,   2263,  12601,  26208,  15268,     78,
             6,    905,   1250,  49410,     86,   3033,  19940,   1740,  12556,
           469,    942,    400,  18735,    851,   3190, 275054,   3806,  59206,
           208,     99,   2041,    162,   2561,  47860,   9165,   2474,   3770,
          4468, 121930,   6131,    903,    500,   7774,   6240,   1728,    145,
           389,   1442,    393,    268,    328,   4661,     38,   7139,   3548,
        152370,     22,  33248,  40600,    696,    103,     62,  36581,    287])
tensor([27, 19, 73, 69, 78, 26, 31, 46, 77, 62, 15, 48, 45, 66, 80, 20, 67, 10,
         0, 16, 63, 65, 38, 36, 58,  3, 76, 40, 57, 28, 37,  2, 29, 64, 21, 17,
        61, 34, 47, 22, 52, 49, 12, 32, 41, 71, 53, 43, 11, 54, 68,  1,  7, 56,
        60, 70, 18, 59,  4,  5, 51, 14, 35, 23,  6, 25, 39, 33,  9, 13, 24, 74,
        79, 75, 50, 30, 44,  8, 55, 72, 42])
class caption num limited:
 tensor([  369,  1289,  1033,   580,  1480,  2217,  1630,  1761, 14125,  3200,
          338,  1049,  1246,  4662,  1213,   157,   370,  1014,  1405,    12,
          309,  1045,  1231,  2059,  2677,  1384,    78,     6,   905,  1015,
         8467,    86,  1105,  3266,  1070,  1666,   469,   942,   400,  3903,
          851,  1592, 29493,  1414,  8971,   208,    99,  1016,   162,  1072,
         7582,  2269,  1178,  1588,  1203, 22214,  1402,   903,   500,  1563,
         1741,  1054,   145,   389,  1089,   393,   268,   328,  1425,    38,
         1373,  1696, 26090,    22,  4623,  8607,   696,   103,    62,  3998,
          287])
===== Caption Distill Data: 456759 nums of word filtered caption  =====
Building transform_train, more augment
+ random resized crop (size=(224, 224), scale=(0.6, 1.0)), chosen with cutout
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
transform_test choices: ('resize', 'center_crop', 'normalize')
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
***** Dataset statistics *****
  Dataset: nuswide_distill_limit
  # classes: 81
  # train_x: 67,573
  # val: 5,393
  # test: 107,859
==================== Building model in Caption_distill_double ======================
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Initial double context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: MLClassification
No checkpoint found, train from scratch
Initializing summary writer for tensorboard with log_dir=output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/tensorboard
epoch [1/20][5/131]	time 0.336 (0.526)	data 0.000 (0.079)	eta 0:22:55	loss 399.9161 (431.0266)	lr 1.000000e-05
epoch [1/20][10/131]	time 0.337 (0.431)	data 0.000 (0.039)	eta 0:18:45	loss 373.9082 (414.9659)	lr 1.000000e-05
epoch [1/20][15/131]	time 0.338 (0.400)	data 0.000 (0.026)	eta 0:17:22	loss 243.8481 (376.0649)	lr 1.000000e-05
epoch [1/20][20/131]	time 0.339 (0.385)	data 0.000 (0.020)	eta 0:16:39	loss 252.4477 (345.5616)	lr 1.000000e-05
epoch [1/20][25/131]	time 0.339 (0.375)	data 0.000 (0.016)	eta 0:16:13	loss 176.8032 (320.5190)	lr 1.000000e-05
epoch [1/20][30/131]	time 0.339 (0.369)	data 0.000 (0.013)	eta 0:15:56	loss 189.6620 (299.4684)	lr 1.000000e-05
epoch [1/20][35/131]	time 0.340 (0.365)	data 0.000 (0.011)	eta 0:15:43	loss 136.7348 (278.2647)	lr 1.000000e-05
epoch [1/20][40/131]	time 0.340 (0.362)	data 0.000 (0.010)	eta 0:15:33	loss 106.8364 (258.2452)	lr 1.000000e-05
epoch [1/20][45/131]	time 0.340 (0.359)	data 0.000 (0.009)	eta 0:15:25	loss 95.7577 (240.6894)	lr 1.000000e-05
epoch [1/20][50/131]	time 0.341 (0.358)	data 0.000 (0.008)	eta 0:15:18	loss 79.0702 (225.2828)	lr 1.000000e-05
epoch [1/20][55/131]	time 0.340 (0.356)	data 0.000 (0.007)	eta 0:15:13	loss 74.7265 (211.9501)	lr 1.000000e-05
epoch [1/20][60/131]	time 0.341 (0.355)	data 0.000 (0.007)	eta 0:15:08	loss 68.8570 (200.3779)	lr 1.000000e-05
epoch [1/20][65/131]	time 0.341 (0.354)	data 0.000 (0.006)	eta 0:15:03	loss 64.5383 (190.2031)	lr 1.000000e-05
epoch [1/20][70/131]	time 0.342 (0.353)	data 0.000 (0.006)	eta 0:14:59	loss 64.9575 (181.4020)	lr 1.000000e-05
epoch [1/20][75/131]	time 0.341 (0.352)	data 0.000 (0.005)	eta 0:14:56	loss 62.5975 (173.4924)	lr 1.000000e-05
epoch [1/20][80/131]	time 0.342 (0.351)	data 0.000 (0.005)	eta 0:14:52	loss 63.1358 (166.5170)	lr 1.000000e-05
epoch [1/20][85/131]	time 0.342 (0.351)	data 0.000 (0.005)	eta 0:14:49	loss 61.3232 (160.2860)	lr 1.000000e-05
epoch [1/20][90/131]	time 0.343 (0.350)	data 0.000 (0.005)	eta 0:14:46	loss 56.8321 (154.5749)	lr 1.000000e-05
epoch [1/20][95/131]	time 0.342 (0.350)	data 0.000 (0.004)	eta 0:14:43	loss 57.9437 (149.4465)	lr 1.000000e-05
epoch [1/20][100/131]	time 0.343 (0.350)	data 0.000 (0.004)	eta 0:14:41	loss 54.5280 (144.8066)	lr 1.000000e-05
epoch [1/20][105/131]	time 0.343 (0.349)	data 0.000 (0.004)	eta 0:14:38	loss 50.6557 (140.5190)	lr 1.000000e-05
epoch [1/20][110/131]	time 0.343 (0.349)	data 0.000 (0.004)	eta 0:14:36	loss 53.5534 (136.6274)	lr 1.000000e-05
epoch [1/20][115/131]	time 0.343 (0.349)	data 0.000 (0.004)	eta 0:14:33	loss 49.3151 (132.8999)	lr 1.000000e-05
epoch [1/20][120/131]	time 0.343 (0.349)	data 0.000 (0.004)	eta 0:14:31	loss 51.1866 (129.5340)	lr 1.000000e-05
epoch [1/20][125/131]	time 0.344 (0.348)	data 0.000 (0.003)	eta 0:14:29	loss 52.0216 (126.4462)	lr 1.000000e-05
epoch [1/20][130/131]	time 0.343 (0.348)	data 0.000 (0.003)	eta 0:14:26	loss 51.3222 (123.5623)	lr 1.000000e-05
Do evaluation on val set
mAP score default: 40.85627118176943
mAP score aux: 38.079703504726844
mAP score merged : preds + preds_aux: 46.7571806468787
mAP score: 46.7571806468787
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar"
epoch [2/20][5/131]	time 0.342 (0.430)	data 0.000 (0.088)	eta 0:17:49	loss 332.4921 (274.9677)	lr 1.000000e-03
epoch [2/20][10/131]	time 0.343 (0.387)	data 0.000 (0.044)	eta 0:15:58	loss 176.7069 (259.8540)	lr 1.000000e-03
epoch [2/20][15/131]	time 0.343 (0.372)	data 0.000 (0.030)	eta 0:15:21	loss 114.0322 (217.7674)	lr 1.000000e-03
epoch [2/20][20/131]	time 0.344 (0.365)	data 0.000 (0.022)	eta 0:15:01	loss 97.4765 (189.0413)	lr 1.000000e-03
epoch [2/20][25/131]	time 0.343 (0.361)	data 0.000 (0.018)	eta 0:14:48	loss 83.2260 (168.3590)	lr 1.000000e-03
epoch [2/20][30/131]	time 0.343 (0.358)	data 0.000 (0.015)	eta 0:14:40	loss 76.5329 (153.6602)	lr 1.000000e-03
epoch [2/20][35/131]	time 0.344 (0.356)	data 0.000 (0.013)	eta 0:14:33	loss 75.1132 (142.5478)	lr 1.000000e-03
epoch [2/20][40/131]	time 0.343 (0.354)	data 0.000 (0.011)	eta 0:14:27	loss 71.2701 (133.5022)	lr 1.000000e-03
epoch [2/20][45/131]	time 0.344 (0.353)	data 0.000 (0.010)	eta 0:14:23	loss 69.0836 (126.2036)	lr 1.000000e-03
epoch [2/20][50/131]	time 0.344 (0.352)	data 0.000 (0.009)	eta 0:14:19	loss 65.7516 (120.0451)	lr 1.000000e-03
epoch [2/20][55/131]	time 0.344 (0.351)	data 0.000 (0.008)	eta 0:14:15	loss 62.9779 (114.8615)	lr 1.000000e-03
epoch [2/20][60/131]	time 0.344 (0.351)	data 0.000 (0.008)	eta 0:14:12	loss 60.5986 (110.4514)	lr 1.000000e-03
epoch [2/20][65/131]	time 0.343 (0.350)	data 0.000 (0.007)	eta 0:14:09	loss 59.1598 (106.5332)	lr 1.000000e-03
epoch [2/20][70/131]	time 0.344 (0.350)	data 0.000 (0.007)	eta 0:14:06	loss 57.7125 (103.0624)	lr 1.000000e-03
epoch [2/20][75/131]	time 0.344 (0.349)	data 0.000 (0.006)	eta 0:14:03	loss 55.9774 (99.9533)	lr 1.000000e-03
epoch [2/20][80/131]	time 0.344 (0.349)	data 0.000 (0.006)	eta 0:14:01	loss 54.6905 (97.2055)	lr 1.000000e-03
epoch [2/20][85/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:13:58	loss 53.5473 (94.6638)	lr 1.000000e-03
epoch [2/20][90/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:13:56	loss 53.9017 (92.3162)	lr 1.000000e-03
epoch [2/20][95/131]	time 0.344 (0.348)	data 0.000 (0.005)	eta 0:13:53	loss 52.2767 (90.2441)	lr 1.000000e-03
epoch [2/20][100/131]	time 0.345 (0.348)	data 0.000 (0.005)	eta 0:13:51	loss 49.0092 (88.3379)	lr 1.000000e-03
epoch [2/20][105/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:13:49	loss 47.8458 (86.5773)	lr 1.000000e-03
epoch [2/20][110/131]	time 0.346 (0.348)	data 0.000 (0.004)	eta 0:13:47	loss 48.4784 (84.9083)	lr 1.000000e-03
epoch [2/20][115/131]	time 0.343 (0.348)	data 0.000 (0.004)	eta 0:13:45	loss 49.2649 (83.3959)	lr 1.000000e-03
epoch [2/20][120/131]	time 0.345 (0.347)	data 0.000 (0.004)	eta 0:13:43	loss 48.9744 (82.0185)	lr 1.000000e-03
epoch [2/20][125/131]	time 0.344 (0.347)	data 0.000 (0.004)	eta 0:13:41	loss 48.7084 (80.6638)	lr 1.000000e-03
epoch [2/20][130/131]	time 0.344 (0.347)	data 0.000 (0.004)	eta 0:13:39	loss 48.4320 (79.4027)	lr 1.000000e-03
Do evaluation on val set
mAP score default: 39.64756469982058
mAP score aux: 40.335653734803465
mAP score merged : preds + preds_aux: 45.593745399894644
mAP score: 45.593745399894644
epoch [3/20][5/131]	time 0.343 (0.410)	data 0.000 (0.067)	eta 0:16:05	loss 44.8929 (47.0534)	lr 9.938442e-04
epoch [3/20][10/131]	time 0.344 (0.377)	data 0.000 (0.034)	eta 0:14:45	loss 45.9995 (47.2667)	lr 9.938442e-04
epoch [3/20][15/131]	time 0.344 (0.366)	data 0.000 (0.023)	eta 0:14:17	loss 47.4915 (46.6438)	lr 9.938442e-04
epoch [3/20][20/131]	time 0.344 (0.361)	data 0.000 (0.017)	eta 0:14:02	loss 46.7001 (47.0598)	lr 9.938442e-04
epoch [3/20][25/131]	time 0.344 (0.357)	data 0.000 (0.014)	eta 0:13:53	loss 43.7391 (46.7199)	lr 9.938442e-04
epoch [3/20][30/131]	time 0.344 (0.355)	data 0.000 (0.011)	eta 0:13:46	loss 42.7617 (46.4224)	lr 9.938442e-04
epoch [3/20][35/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:13:41	loss 43.3776 (46.4026)	lr 9.938442e-04
epoch [3/20][40/131]	time 0.344 (0.352)	data 0.000 (0.009)	eta 0:13:36	loss 44.1845 (46.2709)	lr 9.938442e-04
epoch [3/20][45/131]	time 0.345 (0.351)	data 0.000 (0.008)	eta 0:13:32	loss 42.0864 (46.0433)	lr 9.938442e-04
epoch [3/20][50/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:13:29	loss 45.1034 (46.0304)	lr 9.938442e-04
epoch [3/20][55/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:13:26	loss 43.8154 (45.8463)	lr 9.938442e-04
epoch [3/20][60/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:13:23	loss 46.4698 (45.6852)	lr 9.938442e-04
epoch [3/20][65/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:13:20	loss 48.3281 (45.6880)	lr 9.938442e-04
epoch [3/20][70/131]	time 0.343 (0.349)	data 0.000 (0.005)	eta 0:13:18	loss 44.8553 (45.5289)	lr 9.938442e-04
epoch [3/20][75/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:13:15	loss 40.4575 (45.3545)	lr 9.938442e-04
epoch [3/20][80/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:13:13	loss 42.3567 (45.1868)	lr 9.938442e-04
epoch [3/20][85/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:13:11	loss 44.5868 (44.9712)	lr 9.938442e-04
epoch [3/20][90/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:13:08	loss 41.0691 (44.7805)	lr 9.938442e-04
epoch [3/20][95/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:13:06	loss 43.7403 (44.7018)	lr 9.938442e-04
epoch [3/20][100/131]	time 0.344 (0.347)	data 0.000 (0.004)	eta 0:13:04	loss 44.5328 (44.6318)	lr 9.938442e-04
epoch [3/20][105/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:13:02	loss 41.4223 (44.4930)	lr 9.938442e-04
epoch [3/20][110/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:13:00	loss 40.6794 (44.3813)	lr 9.938442e-04
epoch [3/20][115/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:12:58	loss 37.4625 (44.2109)	lr 9.938442e-04
epoch [3/20][120/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:12:56	loss 40.2543 (44.0617)	lr 9.938442e-04
epoch [3/20][125/131]	time 0.343 (0.347)	data 0.000 (0.003)	eta 0:12:54	loss 42.4356 (43.9528)	lr 9.938442e-04
epoch [3/20][130/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:12:52	loss 42.7677 (43.8097)	lr 9.938442e-04
Do evaluation on val set
mAP score default: 40.95135162752074
mAP score aux: 39.74098750035402
mAP score merged : preds + preds_aux: 46.41851140538159
mAP score: 46.41851140538159
epoch [4/20][5/131]	time 0.343 (0.408)	data 0.000 (0.065)	eta 0:15:06	loss 40.1192 (39.5894)	lr 9.755283e-04
epoch [4/20][10/131]	time 0.344 (0.376)	data 0.000 (0.033)	eta 0:13:54	loss 38.8468 (39.2653)	lr 9.755283e-04
epoch [4/20][15/131]	time 0.345 (0.365)	data 0.000 (0.022)	eta 0:13:28	loss 39.9756 (39.7621)	lr 9.755283e-04
epoch [4/20][20/131]	time 0.344 (0.360)	data 0.000 (0.016)	eta 0:13:14	loss 40.4543 (40.0008)	lr 9.755283e-04
epoch [4/20][25/131]	time 0.344 (0.357)	data 0.000 (0.013)	eta 0:13:06	loss 40.2974 (40.0960)	lr 9.755283e-04
epoch [4/20][30/131]	time 0.345 (0.355)	data 0.000 (0.011)	eta 0:12:59	loss 40.8455 (39.9955)	lr 9.755283e-04
epoch [4/20][35/131]	time 0.344 (0.353)	data 0.000 (0.009)	eta 0:12:54	loss 38.7627 (39.8375)	lr 9.755283e-04
epoch [4/20][40/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:12:50	loss 38.8540 (39.8460)	lr 9.755283e-04
epoch [4/20][45/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:12:46	loss 39.8102 (39.8786)	lr 9.755283e-04
epoch [4/20][50/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:12:43	loss 39.5461 (39.6741)	lr 9.755283e-04
epoch [4/20][55/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:12:40	loss 38.6430 (39.6212)	lr 9.755283e-04
epoch [4/20][60/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:12:37	loss 40.2914 (39.6249)	lr 9.755283e-04
epoch [4/20][65/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:12:35	loss 39.6247 (39.6620)	lr 9.755283e-04
epoch [4/20][70/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:12:32	loss 39.4799 (39.6272)	lr 9.755283e-04
epoch [4/20][75/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:12:30	loss 38.0392 (39.5049)	lr 9.755283e-04
epoch [4/20][80/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:12:27	loss 38.6149 (39.4197)	lr 9.755283e-04
epoch [4/20][85/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:12:25	loss 37.6393 (39.3559)	lr 9.755283e-04
epoch [4/20][90/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:12:23	loss 38.5686 (39.2350)	lr 9.755283e-04
epoch [4/20][95/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:12:21	loss 39.2390 (39.1574)	lr 9.755283e-04
epoch [4/20][100/131]	time 0.345 (0.348)	data 0.000 (0.003)	eta 0:12:19	loss 37.6663 (39.0737)	lr 9.755283e-04
epoch [4/20][105/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:12:17	loss 37.1844 (38.9536)	lr 9.755283e-04
epoch [4/20][110/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:12:15	loss 38.3258 (38.8806)	lr 9.755283e-04
epoch [4/20][115/131]	time 0.346 (0.347)	data 0.000 (0.003)	eta 0:12:13	loss 38.8560 (38.7755)	lr 9.755283e-04
epoch [4/20][120/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:12:11	loss 36.6176 (38.6727)	lr 9.755283e-04
epoch [4/20][125/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:12:09	loss 35.5602 (38.5794)	lr 9.755283e-04
epoch [4/20][130/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:12:07	loss 36.9688 (38.5275)	lr 9.755283e-04
Do evaluation on val set
mAP score default: 42.74229648912675
mAP score aux: 39.324316989706375
mAP score merged : preds + preds_aux: 47.16962519765854
mAP score: 47.16962519765854
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar"
epoch [5/20][5/131]	time 0.343 (0.433)	data 0.000 (0.090)	eta 0:15:05	loss 36.0681 (36.5860)	lr 9.455033e-04
epoch [5/20][10/131]	time 0.345 (0.389)	data 0.000 (0.045)	eta 0:13:30	loss 36.2364 (36.3987)	lr 9.455033e-04
epoch [5/20][15/131]	time 0.346 (0.374)	data 0.000 (0.030)	eta 0:12:58	loss 37.1604 (36.3059)	lr 9.455033e-04
epoch [5/20][20/131]	time 0.345 (0.367)	data 0.000 (0.023)	eta 0:12:40	loss 36.2080 (36.3620)	lr 9.455033e-04
epoch [5/20][25/131]	time 0.345 (0.362)	data 0.000 (0.018)	eta 0:12:29	loss 35.8634 (36.2420)	lr 9.455033e-04
epoch [5/20][30/131]	time 0.343 (0.359)	data 0.000 (0.015)	eta 0:12:21	loss 35.0366 (36.1834)	lr 9.455033e-04
epoch [5/20][35/131]	time 0.344 (0.357)	data 0.000 (0.013)	eta 0:12:15	loss 37.2610 (36.0846)	lr 9.455033e-04
epoch [5/20][40/131]	time 0.346 (0.355)	data 0.000 (0.011)	eta 0:12:10	loss 32.9370 (35.9755)	lr 9.455033e-04
epoch [5/20][45/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:12:06	loss 37.0594 (35.9093)	lr 9.455033e-04
epoch [5/20][50/131]	time 0.344 (0.353)	data 0.000 (0.009)	eta 0:12:02	loss 35.5491 (35.9664)	lr 9.455033e-04
epoch [5/20][55/131]	time 0.345 (0.353)	data 0.000 (0.008)	eta 0:11:59	loss 35.6809 (35.9197)	lr 9.455033e-04
epoch [5/20][60/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:11:56	loss 35.1198 (35.8733)	lr 9.455033e-04
epoch [5/20][65/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:11:53	loss 31.6341 (35.7821)	lr 9.455033e-04
epoch [5/20][70/131]	time 0.346 (0.351)	data 0.000 (0.007)	eta 0:11:50	loss 34.8053 (35.7734)	lr 9.455033e-04
epoch [5/20][75/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:11:48	loss 33.5815 (35.7451)	lr 9.455033e-04
epoch [5/20][80/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:11:45	loss 33.3440 (35.6849)	lr 9.455033e-04
epoch [5/20][85/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:11:43	loss 36.3268 (35.6967)	lr 9.455033e-04
epoch [5/20][90/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:11:40	loss 34.0721 (35.6567)	lr 9.455033e-04
epoch [5/20][95/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:11:38	loss 36.4696 (35.6483)	lr 9.455033e-04
epoch [5/20][100/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:11:36	loss 33.9334 (35.5893)	lr 9.455033e-04
epoch [5/20][105/131]	time 0.346 (0.349)	data 0.000 (0.005)	eta 0:11:34	loss 36.1046 (35.5399)	lr 9.455033e-04
epoch [5/20][110/131]	time 0.345 (0.349)	data 0.000 (0.004)	eta 0:11:32	loss 32.5269 (35.4903)	lr 9.455033e-04
epoch [5/20][115/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:11:30	loss 36.5932 (35.4545)	lr 9.455033e-04
epoch [5/20][120/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:11:28	loss 34.5027 (35.3964)	lr 9.455033e-04
epoch [5/20][125/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:11:26	loss 34.6184 (35.3743)	lr 9.455033e-04
epoch [5/20][130/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:11:24	loss 33.0279 (35.3034)	lr 9.455033e-04
Do evaluation on val set
mAP score default: 44.382485496181495
mAP score aux: 39.123615882207844
mAP score merged : preds + preds_aux: 47.917180219495044
mAP score: 47.917180219495044
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar"
epoch [6/20][5/131]	time 0.343 (0.434)	data 0.000 (0.091)	eta 0:14:10	loss 31.2480 (33.5167)	lr 9.045085e-04
epoch [6/20][10/131]	time 0.345 (0.389)	data 0.000 (0.045)	eta 0:12:40	loss 34.5421 (33.6325)	lr 9.045085e-04
epoch [6/20][15/131]	time 0.345 (0.374)	data 0.000 (0.030)	eta 0:12:09	loss 31.8284 (33.4109)	lr 9.045085e-04
epoch [6/20][20/131]	time 0.344 (0.367)	data 0.000 (0.023)	eta 0:11:53	loss 34.3862 (33.6030)	lr 9.045085e-04
epoch [6/20][25/131]	time 0.344 (0.362)	data 0.000 (0.018)	eta 0:11:42	loss 34.4830 (33.8272)	lr 9.045085e-04
epoch [6/20][30/131]	time 0.345 (0.359)	data 0.000 (0.015)	eta 0:11:35	loss 33.3870 (33.6750)	lr 9.045085e-04
epoch [6/20][35/131]	time 0.344 (0.357)	data 0.000 (0.013)	eta 0:11:29	loss 32.2494 (33.7023)	lr 9.045085e-04
epoch [6/20][40/131]	time 0.344 (0.356)	data 0.000 (0.012)	eta 0:11:24	loss 33.3530 (33.6654)	lr 9.045085e-04
epoch [6/20][45/131]	time 0.343 (0.354)	data 0.000 (0.010)	eta 0:11:20	loss 33.5370 (33.6776)	lr 9.045085e-04
epoch [6/20][50/131]	time 0.346 (0.353)	data 0.000 (0.009)	eta 0:11:16	loss 32.3705 (33.7132)	lr 9.045085e-04
epoch [6/20][55/131]	time 0.344 (0.353)	data 0.000 (0.008)	eta 0:11:13	loss 34.2514 (33.6749)	lr 9.045085e-04
epoch [6/20][60/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:11:10	loss 32.8402 (33.6005)	lr 9.045085e-04
epoch [6/20][65/131]	time 0.346 (0.351)	data 0.000 (0.007)	eta 0:11:07	loss 32.2386 (33.5427)	lr 9.045085e-04
epoch [6/20][70/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:11:04	loss 33.5280 (33.5523)	lr 9.045085e-04
epoch [6/20][75/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:11:02	loss 31.2484 (33.4703)	lr 9.045085e-04
epoch [6/20][80/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:10:59	loss 34.4320 (33.4806)	lr 9.045085e-04
epoch [6/20][85/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:10:57	loss 32.9224 (33.4636)	lr 9.045085e-04
epoch [6/20][90/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:10:55	loss 34.3785 (33.4069)	lr 9.045085e-04
epoch [6/20][95/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:10:52	loss 31.6363 (33.3980)	lr 9.045085e-04
epoch [6/20][100/131]	time 0.346 (0.349)	data 0.000 (0.005)	eta 0:10:50	loss 32.7651 (33.3771)	lr 9.045085e-04
epoch [6/20][105/131]	time 0.343 (0.349)	data 0.000 (0.005)	eta 0:10:48	loss 33.7699 (33.3874)	lr 9.045085e-04
epoch [6/20][110/131]	time 0.345 (0.349)	data 0.000 (0.004)	eta 0:10:46	loss 31.2213 (33.3222)	lr 9.045085e-04
epoch [6/20][115/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:10:44	loss 32.5917 (33.2810)	lr 9.045085e-04
epoch [6/20][120/131]	time 0.343 (0.348)	data 0.000 (0.004)	eta 0:10:42	loss 33.4454 (33.2423)	lr 9.045085e-04
epoch [6/20][125/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:10:40	loss 31.1504 (33.1640)	lr 9.045085e-04
epoch [6/20][130/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:10:38	loss 30.7990 (33.1499)	lr 9.045085e-04
Do evaluation on val set
mAP score default: 45.1938982242225
mAP score aux: 38.5987486109767
mAP score merged : preds + preds_aux: 48.543558570035984
mAP score: 48.543558570035984
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar"
epoch [7/20][5/131]	time 0.342 (0.433)	data 0.000 (0.090)	eta 0:13:12	loss 31.6458 (32.4265)	lr 8.535534e-04
epoch [7/20][10/131]	time 0.344 (0.389)	data 0.000 (0.045)	eta 0:11:49	loss 32.2732 (32.4425)	lr 8.535534e-04
epoch [7/20][15/131]	time 0.345 (0.374)	data 0.000 (0.030)	eta 0:11:20	loss 32.1171 (32.3298)	lr 8.535534e-04
epoch [7/20][20/131]	time 0.344 (0.367)	data 0.000 (0.023)	eta 0:11:04	loss 32.0628 (32.1150)	lr 8.535534e-04
epoch [7/20][25/131]	time 0.345 (0.362)	data 0.000 (0.018)	eta 0:10:55	loss 32.2969 (32.0867)	lr 8.535534e-04
epoch [7/20][30/131]	time 0.344 (0.359)	data 0.000 (0.015)	eta 0:10:47	loss 31.6119 (31.9791)	lr 8.535534e-04
epoch [7/20][35/131]	time 0.345 (0.357)	data 0.000 (0.013)	eta 0:10:42	loss 29.1185 (31.9559)	lr 8.535534e-04
epoch [7/20][40/131]	time 0.344 (0.355)	data 0.000 (0.012)	eta 0:10:37	loss 30.4905 (31.8747)	lr 8.535534e-04
epoch [7/20][45/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:10:33	loss 30.2367 (31.7952)	lr 8.535534e-04
epoch [7/20][50/131]	time 0.344 (0.353)	data 0.000 (0.009)	eta 0:10:30	loss 31.9001 (31.7244)	lr 8.535534e-04
epoch [7/20][55/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:10:26	loss 33.0111 (31.7068)	lr 8.535534e-04
epoch [7/20][60/131]	time 0.345 (0.352)	data 0.000 (0.008)	eta 0:10:23	loss 31.7384 (31.7917)	lr 8.535534e-04
epoch [7/20][65/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:10:21	loss 30.0692 (31.7649)	lr 8.535534e-04
epoch [7/20][70/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:10:18	loss 30.2569 (31.6890)	lr 8.535534e-04
epoch [7/20][75/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:10:16	loss 31.5630 (31.7328)	lr 8.535534e-04
epoch [7/20][80/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:10:13	loss 31.2227 (31.7822)	lr 8.535534e-04
epoch [7/20][85/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:10:11	loss 29.7980 (31.7123)	lr 8.535534e-04
epoch [7/20][90/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:10:09	loss 29.6208 (31.6783)	lr 8.535534e-04
epoch [7/20][95/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:10:07	loss 32.2458 (31.6587)	lr 8.535534e-04
epoch [7/20][100/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:10:04	loss 30.3180 (31.6317)	lr 8.535534e-04
epoch [7/20][105/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:10:02	loss 29.6780 (31.6505)	lr 8.535534e-04
epoch [7/20][110/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:10:00	loss 31.3151 (31.6269)	lr 8.535534e-04
epoch [7/20][115/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:09:58	loss 29.9817 (31.6020)	lr 8.535534e-04
epoch [7/20][120/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:09:56	loss 30.8534 (31.5805)	lr 8.535534e-04
epoch [7/20][125/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:09:54	loss 29.4854 (31.5583)	lr 8.535534e-04
epoch [7/20][130/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:09:52	loss 29.8849 (31.5218)	lr 8.535534e-04
Do evaluation on val set
mAP score default: 45.815351480279794
mAP score aux: 38.54112674566103
mAP score merged : preds + preds_aux: 48.77969788257898
mAP score: 48.77969788257898
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar"
epoch [8/20][5/131]	time 0.343 (0.433)	data 0.000 (0.090)	eta 0:12:15	loss 30.2950 (30.7403)	lr 7.938926e-04
epoch [8/20][10/131]	time 0.345 (0.389)	data 0.000 (0.045)	eta 0:10:57	loss 31.8250 (31.1679)	lr 7.938926e-04
epoch [8/20][15/131]	time 0.343 (0.374)	data 0.000 (0.030)	eta 0:10:30	loss 30.3726 (31.1333)	lr 7.938926e-04
epoch [8/20][20/131]	time 0.344 (0.366)	data 0.000 (0.023)	eta 0:10:16	loss 28.4628 (30.9176)	lr 7.938926e-04
epoch [8/20][25/131]	time 0.344 (0.362)	data 0.000 (0.018)	eta 0:10:07	loss 30.1115 (30.7287)	lr 7.938926e-04
epoch [8/20][30/131]	time 0.345 (0.359)	data 0.000 (0.015)	eta 0:10:00	loss 28.7152 (30.7522)	lr 7.938926e-04
epoch [8/20][35/131]	time 0.344 (0.357)	data 0.000 (0.013)	eta 0:09:55	loss 30.9660 (30.8464)	lr 7.938926e-04
epoch [8/20][40/131]	time 0.345 (0.355)	data 0.000 (0.011)	eta 0:09:51	loss 30.1196 (30.7758)	lr 7.938926e-04
epoch [8/20][45/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:09:47	loss 32.3079 (30.7969)	lr 7.938926e-04
epoch [8/20][50/131]	time 0.345 (0.353)	data 0.000 (0.009)	eta 0:09:44	loss 28.9581 (30.7180)	lr 7.938926e-04
epoch [8/20][55/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:09:40	loss 31.7151 (30.6356)	lr 7.938926e-04
epoch [8/20][60/131]	time 0.345 (0.352)	data 0.000 (0.008)	eta 0:09:38	loss 30.9755 (30.5801)	lr 7.938926e-04
epoch [8/20][65/131]	time 0.343 (0.351)	data 0.000 (0.007)	eta 0:09:35	loss 30.8664 (30.4935)	lr 7.938926e-04
epoch [8/20][70/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:09:32	loss 28.4542 (30.4338)	lr 7.938926e-04
epoch [8/20][75/131]	time 0.346 (0.350)	data 0.000 (0.006)	eta 0:09:30	loss 29.5629 (30.3522)	lr 7.938926e-04
epoch [8/20][80/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:09:28	loss 29.8894 (30.3037)	lr 7.938926e-04
epoch [8/20][85/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:09:25	loss 29.6261 (30.2788)	lr 7.938926e-04
epoch [8/20][90/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:09:23	loss 31.4998 (30.2764)	lr 7.938926e-04
epoch [8/20][95/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:09:21	loss 29.4875 (30.2219)	lr 7.938926e-04
epoch [8/20][100/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:09:19	loss 27.9399 (30.1946)	lr 7.938926e-04
epoch [8/20][105/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:09:17	loss 30.4985 (30.1617)	lr 7.938926e-04
epoch [8/20][110/131]	time 0.345 (0.349)	data 0.000 (0.004)	eta 0:09:15	loss 30.1589 (30.1592)	lr 7.938926e-04
epoch [8/20][115/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:09:13	loss 29.5371 (30.1430)	lr 7.938926e-04
epoch [8/20][120/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:09:11	loss 32.5878 (30.1592)	lr 7.938926e-04
epoch [8/20][125/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:09:09	loss 32.1344 (30.1471)	lr 7.938926e-04
epoch [8/20][130/131]	time 0.343 (0.348)	data 0.000 (0.004)	eta 0:09:07	loss 30.0704 (30.1447)	lr 7.938926e-04
Do evaluation on val set
mAP score default: 47.006220099849756
mAP score aux: 38.29360922708282
mAP score merged : preds + preds_aux: 49.35472914596036
mAP score: 49.35472914596036
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar"
epoch [9/20][5/131]	time 0.343 (0.434)	data 0.000 (0.091)	eta 0:11:19	loss 30.8352 (29.5374)	lr 7.269952e-04
epoch [9/20][10/131]	time 0.345 (0.389)	data 0.000 (0.046)	eta 0:10:07	loss 28.7611 (29.3527)	lr 7.269952e-04
epoch [9/20][15/131]	time 0.344 (0.374)	data 0.000 (0.031)	eta 0:09:42	loss 28.9056 (29.5284)	lr 7.269952e-04
epoch [9/20][20/131]	time 0.344 (0.367)	data 0.000 (0.023)	eta 0:09:29	loss 28.6481 (29.3272)	lr 7.269952e-04
epoch [9/20][25/131]	time 0.345 (0.362)	data 0.000 (0.018)	eta 0:09:20	loss 28.4707 (29.2015)	lr 7.269952e-04
epoch [9/20][30/131]	time 0.344 (0.359)	data 0.000 (0.015)	eta 0:09:13	loss 27.9824 (29.3523)	lr 7.269952e-04
epoch [9/20][35/131]	time 0.344 (0.357)	data 0.000 (0.013)	eta 0:09:08	loss 31.4733 (29.2051)	lr 7.269952e-04
epoch [9/20][40/131]	time 0.345 (0.356)	data 0.000 (0.012)	eta 0:09:04	loss 29.9540 (29.2432)	lr 7.269952e-04
epoch [9/20][45/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:09:01	loss 28.2987 (29.0966)	lr 7.269952e-04
epoch [9/20][50/131]	time 0.345 (0.353)	data 0.000 (0.009)	eta 0:08:57	loss 30.0547 (29.0390)	lr 7.269952e-04
epoch [9/20][55/131]	time 0.343 (0.353)	data 0.000 (0.009)	eta 0:08:54	loss 27.1582 (29.0874)	lr 7.269952e-04
epoch [9/20][60/131]	time 0.347 (0.352)	data 0.000 (0.008)	eta 0:08:52	loss 29.3069 (29.0967)	lr 7.269952e-04
epoch [9/20][65/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:08:49	loss 31.6126 (29.1706)	lr 7.269952e-04
epoch [9/20][70/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:08:46	loss 27.9315 (29.1349)	lr 7.269952e-04
epoch [9/20][75/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:08:44	loss 30.4423 (29.1679)	lr 7.269952e-04
epoch [9/20][80/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:08:42	loss 29.8088 (29.1167)	lr 7.269952e-04
epoch [9/20][85/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:08:40	loss 30.9268 (29.1356)	lr 7.269952e-04
epoch [9/20][90/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:08:37	loss 30.9718 (29.1617)	lr 7.269952e-04
epoch [9/20][95/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:08:35	loss 27.5540 (29.0955)	lr 7.269952e-04
epoch [9/20][100/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:08:33	loss 28.9913 (29.1222)	lr 7.269952e-04
epoch [9/20][105/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:08:31	loss 30.0149 (29.0997)	lr 7.269952e-04
epoch [9/20][110/131]	time 0.344 (0.349)	data 0.000 (0.004)	eta 0:08:29	loss 28.4622 (29.1022)	lr 7.269952e-04
epoch [9/20][115/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:08:27	loss 28.9283 (29.0879)	lr 7.269952e-04
epoch [9/20][120/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:08:25	loss 29.0686 (29.0565)	lr 7.269952e-04
epoch [9/20][125/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:08:23	loss 27.9715 (29.0344)	lr 7.269952e-04
epoch [9/20][130/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:08:21	loss 29.9563 (29.0590)	lr 7.269952e-04
Do evaluation on val set
mAP score default: 47.72578717975038
mAP score aux: 38.19409690756843
mAP score merged : preds + preds_aux: 49.92620594502661
mAP score: 49.92620594502661
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar"
epoch [10/20][5/131]	time 0.343 (0.432)	data 0.000 (0.090)	eta 0:10:20	loss 29.0913 (29.3086)	lr 6.545085e-04
epoch [10/20][10/131]	time 0.344 (0.388)	data 0.000 (0.045)	eta 0:09:15	loss 30.2377 (29.1872)	lr 6.545085e-04
epoch [10/20][15/131]	time 0.345 (0.374)	data 0.000 (0.030)	eta 0:08:52	loss 28.4172 (29.0849)	lr 6.545085e-04
epoch [10/20][20/131]	time 0.344 (0.366)	data 0.000 (0.023)	eta 0:08:40	loss 29.1828 (28.8953)	lr 6.545085e-04
epoch [10/20][25/131]	time 0.344 (0.362)	data 0.000 (0.018)	eta 0:08:32	loss 28.7956 (28.8756)	lr 6.545085e-04
epoch [10/20][30/131]	time 0.345 (0.359)	data 0.000 (0.015)	eta 0:08:26	loss 29.5138 (28.8449)	lr 6.545085e-04
epoch [10/20][35/131]	time 0.344 (0.357)	data 0.000 (0.013)	eta 0:08:21	loss 27.2368 (28.8729)	lr 6.545085e-04
epoch [10/20][40/131]	time 0.345 (0.355)	data 0.000 (0.011)	eta 0:08:17	loss 28.7065 (28.7040)	lr 6.545085e-04
epoch [10/20][45/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:08:14	loss 29.5528 (28.6701)	lr 6.545085e-04
epoch [10/20][50/131]	time 0.345 (0.353)	data 0.000 (0.009)	eta 0:08:11	loss 26.8016 (28.6577)	lr 6.545085e-04
epoch [10/20][55/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:08:08	loss 30.0766 (28.6330)	lr 6.545085e-04
epoch [10/20][60/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:08:05	loss 28.3408 (28.5959)	lr 6.545085e-04
epoch [10/20][65/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:08:03	loss 33.0580 (28.6372)	lr 6.545085e-04
epoch [10/20][70/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:08:00	loss 28.2576 (28.5613)	lr 6.545085e-04
epoch [10/20][75/131]	time 0.343 (0.350)	data 0.000 (0.006)	eta 0:07:58	loss 30.5939 (28.5695)	lr 6.545085e-04
epoch [10/20][80/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:07:56	loss 28.6702 (28.5686)	lr 6.545085e-04
epoch [10/20][85/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:07:53	loss 25.5662 (28.5167)	lr 6.545085e-04
epoch [10/20][90/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:07:51	loss 28.6268 (28.4961)	lr 6.545085e-04
epoch [10/20][95/131]	time 0.346 (0.349)	data 0.000 (0.005)	eta 0:07:49	loss 28.9226 (28.4237)	lr 6.545085e-04
epoch [10/20][100/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:07:47	loss 29.8102 (28.4456)	lr 6.545085e-04
epoch [10/20][105/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:07:45	loss 26.0444 (28.4154)	lr 6.545085e-04
epoch [10/20][110/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:07:43	loss 30.7388 (28.4325)	lr 6.545085e-04
epoch [10/20][115/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:07:41	loss 28.9563 (28.4110)	lr 6.545085e-04
epoch [10/20][120/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:07:39	loss 26.7244 (28.3960)	lr 6.545085e-04
epoch [10/20][125/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:07:37	loss 25.0797 (28.3441)	lr 6.545085e-04
epoch [10/20][130/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:07:35	loss 29.9438 (28.3345)	lr 6.545085e-04
Do evaluation on val set
mAP score default: 47.97553741536616
mAP score aux: 38.238247819448276
mAP score merged : preds + preds_aux: 49.80227034377383
mAP score: 49.80227034377383
epoch [11/20][5/131]	time 0.343 (0.405)	data 0.000 (0.061)	eta 0:08:47	loss 29.1966 (29.1889)	lr 5.782172e-04
epoch [11/20][10/131]	time 0.345 (0.374)	data 0.000 (0.031)	eta 0:08:06	loss 27.3706 (27.9078)	lr 5.782172e-04
epoch [11/20][15/131]	time 0.344 (0.364)	data 0.000 (0.021)	eta 0:07:51	loss 26.8352 (27.8184)	lr 5.782172e-04
epoch [11/20][20/131]	time 0.344 (0.359)	data 0.000 (0.016)	eta 0:07:43	loss 27.3558 (27.8917)	lr 5.782172e-04
epoch [11/20][25/131]	time 0.345 (0.356)	data 0.000 (0.012)	eta 0:07:37	loss 28.2276 (28.0206)	lr 5.782172e-04
epoch [11/20][30/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:07:33	loss 28.2107 (28.0298)	lr 5.782172e-04
epoch [11/20][35/131]	time 0.344 (0.353)	data 0.000 (0.009)	eta 0:07:30	loss 27.0085 (27.9780)	lr 5.782172e-04
epoch [11/20][40/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:07:26	loss 28.4187 (27.9677)	lr 5.782172e-04
epoch [11/20][45/131]	time 0.343 (0.351)	data 0.000 (0.007)	eta 0:07:24	loss 26.0225 (27.9260)	lr 5.782172e-04
epoch [11/20][50/131]	time 0.346 (0.350)	data 0.000 (0.006)	eta 0:07:21	loss 27.3890 (27.9030)	lr 5.782172e-04
epoch [11/20][55/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:07:19	loss 27.2235 (27.9358)	lr 5.782172e-04
epoch [11/20][60/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:07:16	loss 27.6245 (27.9493)	lr 5.782172e-04
epoch [11/20][65/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:07:14	loss 28.0288 (27.9027)	lr 5.782172e-04
epoch [11/20][70/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:07:12	loss 27.1453 (27.9229)	lr 5.782172e-04
epoch [11/20][75/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:07:10	loss 26.4648 (27.8531)	lr 5.782172e-04
epoch [11/20][80/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:07:08	loss 28.2648 (27.8426)	lr 5.782172e-04
epoch [11/20][85/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:07:06	loss 26.8391 (27.8185)	lr 5.782172e-04
epoch [11/20][90/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:07:04	loss 27.5310 (27.8084)	lr 5.782172e-04
epoch [11/20][95/131]	time 0.344 (0.348)	data 0.000 (0.003)	eta 0:07:02	loss 27.6821 (27.8064)	lr 5.782172e-04
epoch [11/20][100/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:07:00	loss 25.8848 (27.7641)	lr 5.782172e-04
epoch [11/20][105/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:06:58	loss 27.0972 (27.7235)	lr 5.782172e-04
epoch [11/20][110/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:06:56	loss 27.0580 (27.7205)	lr 5.782172e-04
epoch [11/20][115/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:06:54	loss 26.7298 (27.7026)	lr 5.782172e-04
epoch [11/20][120/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:06:52	loss 29.5749 (27.7033)	lr 5.782172e-04
epoch [11/20][125/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:06:51	loss 29.6128 (27.7093)	lr 5.782172e-04
epoch [11/20][130/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:06:49	loss 30.0336 (27.7545)	lr 5.782172e-04
Do evaluation on val set
mAP score default: 47.73974971195456
mAP score aux: 38.16043867974783
mAP score merged : preds + preds_aux: 49.864820262701784
mAP score: 49.864820262701784
epoch [12/20][5/131]	time 0.343 (0.404)	data 0.000 (0.061)	eta 0:07:54	loss 27.7527 (27.8712)	lr 5.000000e-04
epoch [12/20][10/131]	time 0.343 (0.374)	data 0.000 (0.030)	eta 0:07:17	loss 28.0152 (27.6711)	lr 5.000000e-04
epoch [12/20][15/131]	time 0.346 (0.364)	data 0.000 (0.020)	eta 0:07:03	loss 27.9330 (27.6920)	lr 5.000000e-04
epoch [12/20][20/131]	time 0.344 (0.359)	data 0.000 (0.015)	eta 0:06:56	loss 27.2380 (27.4886)	lr 5.000000e-04
epoch [12/20][25/131]	time 0.345 (0.356)	data 0.000 (0.012)	eta 0:06:51	loss 28.0071 (27.6914)	lr 5.000000e-04
epoch [12/20][30/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:06:47	loss 29.3693 (27.7419)	lr 5.000000e-04
epoch [12/20][35/131]	time 0.344 (0.353)	data 0.000 (0.009)	eta 0:06:43	loss 25.2954 (27.6530)	lr 5.000000e-04
epoch [12/20][40/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:06:40	loss 28.9061 (27.6365)	lr 5.000000e-04
epoch [12/20][45/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:06:38	loss 25.3669 (27.5468)	lr 5.000000e-04
epoch [12/20][50/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:06:35	loss 28.8736 (27.5533)	lr 5.000000e-04
epoch [12/20][55/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:06:33	loss 28.2003 (27.4964)	lr 5.000000e-04
epoch [12/20][60/131]	time 0.343 (0.349)	data 0.000 (0.005)	eta 0:06:30	loss 24.6270 (27.5153)	lr 5.000000e-04
epoch [12/20][65/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:06:28	loss 29.6296 (27.5441)	lr 5.000000e-04
epoch [12/20][70/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:06:26	loss 26.3025 (27.4939)	lr 5.000000e-04
epoch [12/20][75/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:06:24	loss 27.8908 (27.4363)	lr 5.000000e-04
epoch [12/20][80/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:06:22	loss 29.0884 (27.4972)	lr 5.000000e-04
epoch [12/20][85/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:06:20	loss 29.0937 (27.5131)	lr 5.000000e-04
epoch [12/20][90/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:06:18	loss 28.1161 (27.4737)	lr 5.000000e-04
epoch [12/20][95/131]	time 0.346 (0.348)	data 0.000 (0.003)	eta 0:06:16	loss 26.4088 (27.4657)	lr 5.000000e-04
epoch [12/20][100/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:06:14	loss 28.4951 (27.4324)	lr 5.000000e-04
epoch [12/20][105/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:06:13	loss 27.5982 (27.4198)	lr 5.000000e-04
epoch [12/20][110/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:06:11	loss 27.7971 (27.3880)	lr 5.000000e-04
epoch [12/20][115/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:06:09	loss 26.4000 (27.3717)	lr 5.000000e-04
epoch [12/20][120/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:06:07	loss 25.0982 (27.3710)	lr 5.000000e-04
epoch [12/20][125/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:06:05	loss 24.5830 (27.3241)	lr 5.000000e-04
epoch [12/20][130/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:06:03	loss 28.2298 (27.3565)	lr 5.000000e-04
Do evaluation on val set
mAP score default: 48.19786592470853
mAP score aux: 38.1340733926165
mAP score merged : preds + preds_aux: 50.05330764547406
mAP score: 50.05330764547406
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar"
epoch [13/20][5/131]	time 0.343 (0.436)	data 0.000 (0.093)	eta 0:07:35	loss 28.2300 (26.9328)	lr 4.217828e-04
epoch [13/20][10/131]	time 0.344 (0.390)	data 0.000 (0.047)	eta 0:06:45	loss 27.5590 (27.0165)	lr 4.217828e-04
epoch [13/20][15/131]	time 0.344 (0.375)	data 0.000 (0.031)	eta 0:06:27	loss 27.3335 (27.2152)	lr 4.217828e-04
epoch [13/20][20/131]	time 0.343 (0.367)	data 0.000 (0.023)	eta 0:06:17	loss 26.5828 (27.0379)	lr 4.217828e-04
epoch [13/20][25/131]	time 0.345 (0.363)	data 0.000 (0.019)	eta 0:06:11	loss 26.4531 (27.0566)	lr 4.217828e-04
epoch [13/20][30/131]	time 0.344 (0.360)	data 0.000 (0.016)	eta 0:06:06	loss 26.0549 (26.9812)	lr 4.217828e-04
epoch [13/20][35/131]	time 0.344 (0.357)	data 0.000 (0.013)	eta 0:06:02	loss 26.6641 (26.9399)	lr 4.217828e-04
epoch [13/20][40/131]	time 0.345 (0.356)	data 0.000 (0.012)	eta 0:05:58	loss 28.3464 (26.9660)	lr 4.217828e-04
epoch [13/20][45/131]	time 0.344 (0.354)	data 0.000 (0.011)	eta 0:05:55	loss 25.3421 (26.9668)	lr 4.217828e-04
epoch [13/20][50/131]	time 0.345 (0.353)	data 0.000 (0.010)	eta 0:05:52	loss 25.0472 (26.8924)	lr 4.217828e-04
epoch [13/20][55/131]	time 0.343 (0.353)	data 0.000 (0.009)	eta 0:05:50	loss 26.8786 (26.8986)	lr 4.217828e-04
epoch [13/20][60/131]	time 0.346 (0.352)	data 0.000 (0.008)	eta 0:05:47	loss 27.0662 (26.8287)	lr 4.217828e-04
epoch [13/20][65/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:05:45	loss 27.2929 (26.9286)	lr 4.217828e-04
epoch [13/20][70/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:05:43	loss 28.2045 (26.9453)	lr 4.217828e-04
epoch [13/20][75/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:05:41	loss 27.6811 (26.9558)	lr 4.217828e-04
epoch [13/20][80/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:05:38	loss 26.1458 (26.9540)	lr 4.217828e-04
epoch [13/20][85/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:05:36	loss 28.3715 (26.9853)	lr 4.217828e-04
epoch [13/20][90/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:05:34	loss 26.5836 (27.0232)	lr 4.217828e-04
epoch [13/20][95/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:05:32	loss 27.0454 (27.0322)	lr 4.217828e-04
epoch [13/20][100/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:05:30	loss 27.2580 (26.9919)	lr 4.217828e-04
epoch [13/20][105/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:05:28	loss 27.1649 (27.0046)	lr 4.217828e-04
epoch [13/20][110/131]	time 0.344 (0.349)	data 0.000 (0.004)	eta 0:05:26	loss 25.1200 (26.9951)	lr 4.217828e-04
epoch [13/20][115/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:05:25	loss 26.7215 (27.0103)	lr 4.217828e-04
epoch [13/20][120/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:05:23	loss 27.2801 (27.0205)	lr 4.217828e-04
epoch [13/20][125/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:05:21	loss 26.7416 (27.0281)	lr 4.217828e-04
epoch [13/20][130/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:05:19	loss 26.8495 (27.0419)	lr 4.217828e-04
Do evaluation on val set
mAP score default: 48.29660736205047
mAP score aux: 38.28347119858063
mAP score merged : preds + preds_aux: 49.983453305765785
mAP score: 49.983453305765785
epoch [14/20][5/131]	time 0.343 (0.409)	data 0.000 (0.066)	eta 0:06:12	loss 25.8298 (26.1578)	lr 3.454915e-04
epoch [14/20][10/131]	time 0.345 (0.377)	data 0.000 (0.033)	eta 0:05:41	loss 28.7517 (26.6568)	lr 3.454915e-04
epoch [14/20][15/131]	time 0.344 (0.366)	data 0.000 (0.022)	eta 0:05:29	loss 25.2996 (26.5899)	lr 3.454915e-04
epoch [14/20][20/131]	time 0.344 (0.360)	data 0.000 (0.017)	eta 0:05:23	loss 26.7528 (26.5981)	lr 3.454915e-04
epoch [14/20][25/131]	time 0.344 (0.357)	data 0.000 (0.013)	eta 0:05:18	loss 25.4518 (26.6535)	lr 3.454915e-04
epoch [14/20][30/131]	time 0.346 (0.355)	data 0.000 (0.011)	eta 0:05:14	loss 25.2670 (26.5043)	lr 3.454915e-04
epoch [14/20][35/131]	time 0.344 (0.353)	data 0.000 (0.010)	eta 0:05:11	loss 26.3989 (26.5130)	lr 3.454915e-04
epoch [14/20][40/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:05:09	loss 27.0327 (26.5077)	lr 3.454915e-04
epoch [14/20][45/131]	time 0.345 (0.351)	data 0.000 (0.008)	eta 0:05:06	loss 25.6294 (26.5474)	lr 3.454915e-04
epoch [14/20][50/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:05:04	loss 28.0049 (26.5560)	lr 3.454915e-04
epoch [14/20][55/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:05:01	loss 25.9861 (26.5931)	lr 3.454915e-04
epoch [14/20][60/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:04:59	loss 26.4315 (26.6098)	lr 3.454915e-04
epoch [14/20][65/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:04:57	loss 27.1281 (26.6281)	lr 3.454915e-04
epoch [14/20][70/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:04:55	loss 27.8064 (26.7048)	lr 3.454915e-04
epoch [14/20][75/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:04:53	loss 26.8600 (26.7160)	lr 3.454915e-04
epoch [14/20][80/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:04:51	loss 26.4649 (26.7200)	lr 3.454915e-04
epoch [14/20][85/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:04:49	loss 25.6259 (26.7149)	lr 3.454915e-04
epoch [14/20][90/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:04:47	loss 26.8677 (26.7410)	lr 3.454915e-04
epoch [14/20][95/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:04:45	loss 26.3078 (26.7335)	lr 3.454915e-04
epoch [14/20][100/131]	time 0.343 (0.348)	data 0.000 (0.004)	eta 0:04:43	loss 26.4524 (26.7319)	lr 3.454915e-04
epoch [14/20][105/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:04:42	loss 25.9758 (26.7509)	lr 3.454915e-04
epoch [14/20][110/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:04:40	loss 27.9433 (26.7827)	lr 3.454915e-04
epoch [14/20][115/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:04:38	loss 27.8075 (26.7947)	lr 3.454915e-04
epoch [14/20][120/131]	time 0.346 (0.347)	data 0.000 (0.003)	eta 0:04:36	loss 27.2215 (26.7899)	lr 3.454915e-04
epoch [14/20][125/131]	time 0.343 (0.347)	data 0.000 (0.003)	eta 0:04:34	loss 26.2831 (26.7852)	lr 3.454915e-04
epoch [14/20][130/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:04:32	loss 26.3810 (26.7999)	lr 3.454915e-04
Do evaluation on val set
mAP score default: 48.32616987218999
mAP score aux: 38.36554504749146
mAP score merged : preds + preds_aux: 50.088325954607114
mAP score: 50.088325954607114
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar"
epoch [15/20][5/131]	time 0.344 (0.437)	data 0.000 (0.094)	eta 0:05:41	loss 28.8864 (26.8752)	lr 2.730048e-04
epoch [15/20][10/131]	time 0.344 (0.390)	data 0.000 (0.047)	eta 0:05:02	loss 26.7111 (27.1106)	lr 2.730048e-04
epoch [15/20][15/131]	time 0.343 (0.375)	data 0.000 (0.031)	eta 0:04:49	loss 26.3124 (27.0791)	lr 2.730048e-04
epoch [15/20][20/131]	time 0.345 (0.367)	data 0.000 (0.024)	eta 0:04:41	loss 28.7647 (27.1046)	lr 2.730048e-04
epoch [15/20][25/131]	time 0.345 (0.363)	data 0.000 (0.019)	eta 0:04:36	loss 25.6436 (26.7737)	lr 2.730048e-04
epoch [15/20][30/131]	time 0.345 (0.360)	data 0.000 (0.016)	eta 0:04:31	loss 26.5806 (26.8463)	lr 2.730048e-04
epoch [15/20][35/131]	time 0.344 (0.358)	data 0.000 (0.014)	eta 0:04:28	loss 27.5643 (26.8605)	lr 2.730048e-04
epoch [15/20][40/131]	time 0.344 (0.356)	data 0.000 (0.012)	eta 0:04:25	loss 26.6136 (26.8423)	lr 2.730048e-04
epoch [15/20][45/131]	time 0.345 (0.355)	data 0.000 (0.011)	eta 0:04:22	loss 27.9891 (26.8631)	lr 2.730048e-04
epoch [15/20][50/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:04:20	loss 24.2459 (26.7785)	lr 2.730048e-04
epoch [15/20][55/131]	time 0.345 (0.353)	data 0.000 (0.009)	eta 0:04:17	loss 26.1073 (26.7727)	lr 2.730048e-04
epoch [15/20][60/131]	time 0.345 (0.352)	data 0.000 (0.008)	eta 0:04:15	loss 24.5942 (26.7081)	lr 2.730048e-04
epoch [15/20][65/131]	time 0.345 (0.352)	data 0.000 (0.007)	eta 0:04:13	loss 26.1884 (26.7112)	lr 2.730048e-04
epoch [15/20][70/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:04:11	loss 26.3751 (26.7088)	lr 2.730048e-04
epoch [15/20][75/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:04:09	loss 27.5377 (26.7418)	lr 2.730048e-04
epoch [15/20][80/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:04:07	loss 27.2237 (26.7508)	lr 2.730048e-04
epoch [15/20][85/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:04:05	loss 26.8071 (26.7566)	lr 2.730048e-04
epoch [15/20][90/131]	time 0.344 (0.350)	data 0.000 (0.005)	eta 0:04:03	loss 26.2854 (26.7246)	lr 2.730048e-04
epoch [15/20][95/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:04:01	loss 28.6126 (26.7119)	lr 2.730048e-04
epoch [15/20][100/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:03:59	loss 28.2590 (26.6952)	lr 2.730048e-04
epoch [15/20][105/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:03:57	loss 25.3242 (26.7242)	lr 2.730048e-04
epoch [15/20][110/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:03:55	loss 26.9428 (26.7348)	lr 2.730048e-04
epoch [15/20][115/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:03:53	loss 25.3823 (26.7322)	lr 2.730048e-04
epoch [15/20][120/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:03:51	loss 26.4277 (26.6939)	lr 2.730048e-04
epoch [15/20][125/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:03:50	loss 27.0767 (26.7090)	lr 2.730048e-04
epoch [15/20][130/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:03:48	loss 27.0556 (26.6827)	lr 2.730048e-04
Do evaluation on val set
mAP score default: 48.464159533846455
mAP score aux: 38.28814973894323
mAP score merged : preds + preds_aux: 50.320337597588946
mAP score: 50.320337597588946
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar"
epoch [16/20][5/131]	time 0.344 (0.440)	data 0.000 (0.097)	eta 0:04:45	loss 24.4770 (26.6361)	lr 2.061074e-04
epoch [16/20][10/131]	time 0.345 (0.392)	data 0.000 (0.049)	eta 0:04:12	loss 26.9827 (26.8221)	lr 2.061074e-04
epoch [16/20][15/131]	time 0.344 (0.376)	data 0.000 (0.033)	eta 0:04:00	loss 26.9793 (27.0105)	lr 2.061074e-04
epoch [16/20][20/131]	time 0.344 (0.368)	data 0.000 (0.025)	eta 0:03:53	loss 27.0404 (27.0623)	lr 2.061074e-04
epoch [16/20][25/131]	time 0.344 (0.363)	data 0.000 (0.020)	eta 0:03:48	loss 26.1449 (26.8673)	lr 2.061074e-04
epoch [16/20][30/131]	time 0.345 (0.360)	data 0.000 (0.016)	eta 0:03:45	loss 27.6637 (26.7362)	lr 2.061074e-04
epoch [16/20][35/131]	time 0.344 (0.358)	data 0.000 (0.014)	eta 0:03:41	loss 26.1595 (26.6548)	lr 2.061074e-04
epoch [16/20][40/131]	time 0.345 (0.356)	data 0.000 (0.012)	eta 0:03:39	loss 25.7520 (26.5717)	lr 2.061074e-04
epoch [16/20][45/131]	time 0.344 (0.355)	data 0.000 (0.011)	eta 0:03:36	loss 28.0473 (26.5755)	lr 2.061074e-04
epoch [16/20][50/131]	time 0.345 (0.354)	data 0.000 (0.010)	eta 0:03:34	loss 26.4322 (26.6259)	lr 2.061074e-04
epoch [16/20][55/131]	time 0.344 (0.353)	data 0.000 (0.009)	eta 0:03:31	loss 26.6157 (26.6248)	lr 2.061074e-04
epoch [16/20][60/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:03:29	loss 26.0606 (26.5177)	lr 2.061074e-04
epoch [16/20][65/131]	time 0.345 (0.352)	data 0.000 (0.008)	eta 0:03:27	loss 27.9984 (26.4957)	lr 2.061074e-04
epoch [16/20][70/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:03:25	loss 26.1375 (26.5474)	lr 2.061074e-04
epoch [16/20][75/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:03:23	loss 24.9688 (26.4962)	lr 2.061074e-04
epoch [16/20][80/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:03:21	loss 25.6832 (26.4567)	lr 2.061074e-04
epoch [16/20][85/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:03:19	loss 27.2469 (26.4568)	lr 2.061074e-04
epoch [16/20][90/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:03:17	loss 27.2175 (26.4333)	lr 2.061074e-04
epoch [16/20][95/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:03:15	loss 26.4904 (26.4315)	lr 2.061074e-04
epoch [16/20][100/131]	time 0.346 (0.349)	data 0.000 (0.005)	eta 0:03:13	loss 27.3860 (26.4409)	lr 2.061074e-04
epoch [16/20][105/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:03:11	loss 27.4975 (26.4661)	lr 2.061074e-04
epoch [16/20][110/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:03:10	loss 26.3549 (26.4332)	lr 2.061074e-04
epoch [16/20][115/131]	time 0.345 (0.349)	data 0.000 (0.004)	eta 0:03:08	loss 28.2917 (26.4455)	lr 2.061074e-04
epoch [16/20][120/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:03:06	loss 27.5735 (26.4717)	lr 2.061074e-04
epoch [16/20][125/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:03:04	loss 26.0770 (26.4522)	lr 2.061074e-04
epoch [16/20][130/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:03:02	loss 29.4461 (26.5019)	lr 2.061074e-04
Do evaluation on val set
mAP score default: 48.340178421328986
mAP score aux: 38.281564952577924
mAP score merged : preds + preds_aux: 50.16966588431141
mAP score: 50.16966588431141
epoch [17/20][5/131]	time 0.343 (0.404)	data 0.000 (0.060)	eta 0:03:29	loss 26.7241 (26.5199)	lr 1.464466e-04
epoch [17/20][10/131]	time 0.345 (0.374)	data 0.000 (0.030)	eta 0:03:12	loss 25.2809 (25.7491)	lr 1.464466e-04
epoch [17/20][15/131]	time 0.343 (0.364)	data 0.000 (0.020)	eta 0:03:05	loss 25.1090 (25.9325)	lr 1.464466e-04
epoch [17/20][20/131]	time 0.346 (0.359)	data 0.000 (0.015)	eta 0:03:01	loss 25.8953 (26.1236)	lr 1.464466e-04
epoch [17/20][25/131]	time 0.343 (0.356)	data 0.000 (0.012)	eta 0:02:57	loss 25.6930 (26.1614)	lr 1.464466e-04
epoch [17/20][30/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:02:54	loss 29.1745 (26.3500)	lr 1.464466e-04
epoch [17/20][35/131]	time 0.345 (0.353)	data 0.000 (0.009)	eta 0:02:52	loss 27.4229 (26.4574)	lr 1.464466e-04
epoch [17/20][40/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:02:50	loss 28.3291 (26.5311)	lr 1.464466e-04
epoch [17/20][45/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:02:48	loss 25.1961 (26.4407)	lr 1.464466e-04
epoch [17/20][50/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:02:46	loss 27.6594 (26.4334)	lr 1.464466e-04
epoch [17/20][55/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:02:44	loss 26.5260 (26.3378)	lr 1.464466e-04
epoch [17/20][60/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:02:42	loss 27.4999 (26.3100)	lr 1.464466e-04
epoch [17/20][65/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:02:40	loss 26.8715 (26.3245)	lr 1.464466e-04
epoch [17/20][70/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:02:38	loss 27.2545 (26.3588)	lr 1.464466e-04
epoch [17/20][75/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:02:36	loss 28.3460 (26.3999)	lr 1.464466e-04
epoch [17/20][80/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:02:34	loss 26.3713 (26.4119)	lr 1.464466e-04
epoch [17/20][85/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:02:32	loss 27.3175 (26.4295)	lr 1.464466e-04
epoch [17/20][90/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:02:30	loss 28.6416 (26.4518)	lr 1.464466e-04
epoch [17/20][95/131]	time 0.345 (0.348)	data 0.000 (0.003)	eta 0:02:29	loss 25.7606 (26.4549)	lr 1.464466e-04
epoch [17/20][100/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:02:27	loss 28.4509 (26.4767)	lr 1.464466e-04
epoch [17/20][105/131]	time 0.346 (0.347)	data 0.000 (0.003)	eta 0:02:25	loss 26.9271 (26.4878)	lr 1.464466e-04
epoch [17/20][110/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:02:23	loss 26.5291 (26.4540)	lr 1.464466e-04
epoch [17/20][115/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:02:21	loss 25.2316 (26.4198)	lr 1.464466e-04
epoch [17/20][120/131]	time 0.346 (0.347)	data 0.000 (0.003)	eta 0:02:20	loss 26.9590 (26.3993)	lr 1.464466e-04
epoch [17/20][125/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:02:18	loss 28.9968 (26.4294)	lr 1.464466e-04
epoch [17/20][130/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:02:16	loss 24.6811 (26.4367)	lr 1.464466e-04
Do evaluation on val set
mAP score default: 48.49025225884047
mAP score aux: 38.23817558201485
mAP score merged : preds + preds_aux: 50.122597872832785
mAP score: 50.122597872832785
epoch [18/20][5/131]	time 0.344 (0.410)	data 0.000 (0.067)	eta 0:02:39	loss 26.2666 (26.0371)	lr 9.549150e-05
epoch [18/20][10/131]	time 0.344 (0.377)	data 0.000 (0.034)	eta 0:02:24	loss 25.0783 (25.9872)	lr 9.549150e-05
epoch [18/20][15/131]	time 0.345 (0.366)	data 0.000 (0.022)	eta 0:02:18	loss 24.8270 (26.0405)	lr 9.549150e-05
epoch [18/20][20/131]	time 0.345 (0.361)	data 0.000 (0.017)	eta 0:02:14	loss 24.5549 (26.0119)	lr 9.549150e-05
epoch [18/20][25/131]	time 0.344 (0.357)	data 0.000 (0.014)	eta 0:02:11	loss 24.5347 (25.9922)	lr 9.549150e-05
epoch [18/20][30/131]	time 0.345 (0.355)	data 0.000 (0.011)	eta 0:02:08	loss 26.7111 (26.1988)	lr 9.549150e-05
epoch [18/20][35/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:02:06	loss 26.5630 (26.3494)	lr 9.549150e-05
epoch [18/20][40/131]	time 0.345 (0.353)	data 0.000 (0.009)	eta 0:02:04	loss 26.6213 (26.3505)	lr 9.549150e-05
epoch [18/20][45/131]	time 0.344 (0.352)	data 0.000 (0.008)	eta 0:02:02	loss 25.4873 (26.1739)	lr 9.549150e-05
epoch [18/20][50/131]	time 0.345 (0.351)	data 0.000 (0.007)	eta 0:02:00	loss 26.6557 (26.2096)	lr 9.549150e-05
epoch [18/20][55/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:01:58	loss 25.3703 (26.2336)	lr 9.549150e-05
epoch [18/20][60/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:01:56	loss 24.4743 (26.2555)	lr 9.549150e-05
epoch [18/20][65/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:01:54	loss 26.5648 (26.2354)	lr 9.549150e-05
epoch [18/20][70/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:01:52	loss 27.0118 (26.2485)	lr 9.549150e-05
epoch [18/20][75/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:01:50	loss 27.4802 (26.2474)	lr 9.549150e-05
epoch [18/20][80/131]	time 0.345 (0.349)	data 0.000 (0.004)	eta 0:01:49	loss 24.8004 (26.2492)	lr 9.549150e-05
epoch [18/20][85/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:01:47	loss 27.3354 (26.2782)	lr 9.549150e-05
epoch [18/20][90/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:01:45	loss 26.6415 (26.3401)	lr 9.549150e-05
epoch [18/20][95/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:01:43	loss 26.0427 (26.3444)	lr 9.549150e-05
epoch [18/20][100/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:01:41	loss 24.0644 (26.3271)	lr 9.549150e-05
epoch [18/20][105/131]	time 0.345 (0.348)	data 0.000 (0.003)	eta 0:01:40	loss 26.7478 (26.3696)	lr 9.549150e-05
epoch [18/20][110/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:01:38	loss 24.3932 (26.3443)	lr 9.549150e-05
epoch [18/20][115/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:01:36	loss 26.4421 (26.3229)	lr 9.549150e-05
epoch [18/20][120/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:01:34	loss 25.1218 (26.3299)	lr 9.549150e-05
epoch [18/20][125/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:01:33	loss 27.3138 (26.3290)	lr 9.549150e-05
epoch [18/20][130/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:01:31	loss 25.5412 (26.3477)	lr 9.549150e-05
Do evaluation on val set
mAP score default: 48.334119014076926
mAP score aux: 38.277120831751084
mAP score merged : preds + preds_aux: 50.12337728249532
mAP score: 50.12337728249532
epoch [19/20][5/131]	time 0.343 (0.405)	data 0.000 (0.062)	eta 0:01:44	loss 26.7713 (26.6240)	lr 5.449674e-05
epoch [19/20][10/131]	time 0.344 (0.375)	data 0.000 (0.031)	eta 0:01:34	loss 29.0314 (27.2231)	lr 5.449674e-05
epoch [19/20][15/131]	time 0.344 (0.365)	data 0.000 (0.021)	eta 0:01:30	loss 24.9791 (26.7082)	lr 5.449674e-05
epoch [19/20][20/131]	time 0.344 (0.359)	data 0.000 (0.016)	eta 0:01:26	loss 28.1740 (26.6910)	lr 5.449674e-05
epoch [19/20][25/131]	time 0.345 (0.356)	data 0.000 (0.013)	eta 0:01:24	loss 25.4929 (26.5091)	lr 5.449674e-05
epoch [19/20][30/131]	time 0.344 (0.354)	data 0.000 (0.011)	eta 0:01:22	loss 28.1207 (26.4058)	lr 5.449674e-05
epoch [19/20][35/131]	time 0.345 (0.353)	data 0.000 (0.009)	eta 0:01:20	loss 27.2521 (26.3950)	lr 5.449674e-05
epoch [19/20][40/131]	time 0.345 (0.352)	data 0.000 (0.008)	eta 0:01:18	loss 24.8731 (26.4074)	lr 5.449674e-05
epoch [19/20][45/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:01:16	loss 24.5250 (26.3247)	lr 5.449674e-05
epoch [19/20][50/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:01:14	loss 25.7295 (26.3041)	lr 5.449674e-05
epoch [19/20][55/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:01:12	loss 26.9322 (26.3119)	lr 5.449674e-05
epoch [19/20][60/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:01:10	loss 26.8236 (26.2511)	lr 5.449674e-05
epoch [19/20][65/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:01:08	loss 27.9848 (26.3221)	lr 5.449674e-05
epoch [19/20][70/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:01:06	loss 26.3641 (26.3309)	lr 5.449674e-05
epoch [19/20][75/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:01:05	loss 26.4105 (26.3518)	lr 5.449674e-05
epoch [19/20][80/131]	time 0.343 (0.348)	data 0.000 (0.004)	eta 0:01:03	loss 25.8159 (26.2932)	lr 5.449674e-05
epoch [19/20][85/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:01:01	loss 27.0791 (26.3133)	lr 5.449674e-05
epoch [19/20][90/131]	time 0.346 (0.348)	data 0.000 (0.004)	eta 0:00:59	loss 27.2830 (26.2829)	lr 5.449674e-05
epoch [19/20][95/131]	time 0.344 (0.348)	data 0.000 (0.003)	eta 0:00:58	loss 23.6555 (26.2582)	lr 5.449674e-05
epoch [19/20][100/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:00:56	loss 25.1061 (26.2684)	lr 5.449674e-05
epoch [19/20][105/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:00:54	loss 25.9532 (26.2712)	lr 5.449674e-05
epoch [19/20][110/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:00:52	loss 27.5259 (26.3091)	lr 5.449674e-05
epoch [19/20][115/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:00:51	loss 26.0233 (26.3067)	lr 5.449674e-05
epoch [19/20][120/131]	time 0.343 (0.347)	data 0.000 (0.003)	eta 0:00:49	loss 27.0424 (26.3251)	lr 5.449674e-05
epoch [19/20][125/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:00:47	loss 25.6713 (26.2678)	lr 5.449674e-05
epoch [19/20][130/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:00:45	loss 27.8298 (26.2733)	lr 5.449674e-05
Do evaluation on val set
mAP score default: 48.28763236515839
mAP score aux: 38.2692628705939
mAP score merged : preds + preds_aux: 50.183213985343734
mAP score: 50.183213985343734
epoch [20/20][5/131]	time 0.343 (0.404)	data 0.000 (0.061)	eta 0:00:50	loss 25.4293 (25.6150)	lr 2.447174e-05
epoch [20/20][10/131]	time 0.345 (0.374)	data 0.000 (0.031)	eta 0:00:45	loss 27.4203 (26.6440)	lr 2.447174e-05
epoch [20/20][15/131]	time 0.343 (0.364)	data 0.000 (0.020)	eta 0:00:42	loss 26.6241 (26.5865)	lr 2.447174e-05
epoch [20/20][20/131]	time 0.345 (0.359)	data 0.000 (0.015)	eta 0:00:39	loss 26.6554 (26.4641)	lr 2.447174e-05
epoch [20/20][25/131]	time 0.344 (0.356)	data 0.000 (0.012)	eta 0:00:37	loss 27.4078 (26.3949)	lr 2.447174e-05
epoch [20/20][30/131]	time 0.344 (0.354)	data 0.000 (0.010)	eta 0:00:35	loss 27.4036 (26.3940)	lr 2.447174e-05
epoch [20/20][35/131]	time 0.344 (0.353)	data 0.000 (0.009)	eta 0:00:33	loss 26.9537 (26.3304)	lr 2.447174e-05
epoch [20/20][40/131]	time 0.345 (0.352)	data 0.000 (0.008)	eta 0:00:32	loss 25.6883 (26.2978)	lr 2.447174e-05
epoch [20/20][45/131]	time 0.344 (0.351)	data 0.000 (0.007)	eta 0:00:30	loss 25.2215 (26.2345)	lr 2.447174e-05
epoch [20/20][50/131]	time 0.344 (0.350)	data 0.000 (0.006)	eta 0:00:28	loss 26.2309 (26.1690)	lr 2.447174e-05
epoch [20/20][55/131]	time 0.345 (0.350)	data 0.000 (0.006)	eta 0:00:26	loss 27.1530 (26.1680)	lr 2.447174e-05
epoch [20/20][60/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:00:24	loss 25.6393 (26.1759)	lr 2.447174e-05
epoch [20/20][65/131]	time 0.345 (0.349)	data 0.000 (0.005)	eta 0:00:23	loss 26.1426 (26.1834)	lr 2.447174e-05
epoch [20/20][70/131]	time 0.344 (0.349)	data 0.000 (0.005)	eta 0:00:21	loss 27.1166 (26.2499)	lr 2.447174e-05
epoch [20/20][75/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:00:19	loss 26.4618 (26.2546)	lr 2.447174e-05
epoch [20/20][80/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:00:17	loss 27.3467 (26.3082)	lr 2.447174e-05
epoch [20/20][85/131]	time 0.345 (0.348)	data 0.000 (0.004)	eta 0:00:16	loss 27.5805 (26.3567)	lr 2.447174e-05
epoch [20/20][90/131]	time 0.344 (0.348)	data 0.000 (0.004)	eta 0:00:14	loss 26.3948 (26.3363)	lr 2.447174e-05
epoch [20/20][95/131]	time 0.345 (0.348)	data 0.000 (0.003)	eta 0:00:12	loss 29.1102 (26.3545)	lr 2.447174e-05
epoch [20/20][100/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:00:10	loss 24.7968 (26.3052)	lr 2.447174e-05
epoch [20/20][105/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:00:09	loss 25.6168 (26.2711)	lr 2.447174e-05
epoch [20/20][110/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:00:07	loss 25.0301 (26.2359)	lr 2.447174e-05
epoch [20/20][115/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:00:05	loss 28.0178 (26.2415)	lr 2.447174e-05
epoch [20/20][120/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:00:03	loss 26.1605 (26.2523)	lr 2.447174e-05
epoch [20/20][125/131]	time 0.344 (0.347)	data 0.000 (0.003)	eta 0:00:02	loss 25.7902 (26.2451)	lr 2.447174e-05
epoch [20/20][130/131]	time 0.345 (0.347)	data 0.000 (0.003)	eta 0:00:00	loss 24.8786 (26.2488)	lr 2.447174e-05
Do evaluation on val set
mAP score default: 48.30082448705861
mAP score aux: 38.27051579760194
mAP score merged : preds + preds_aux: 50.200953585283
mAP score: 50.200953585283
Checkpoint saved to "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model.pth.tar-20"
Finished training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/nuswide_caption/Caption_distill_double/rn50_nuswide/nctx16_cscFalse_ctpend/seed3/prompt_learner/model-best.pth.tar" (epoch = 15)
OrderedDict([('ctx', tensor([[ 0.0674, -0.0338,  0.2554,  ...,  0.2537,  0.0491,  0.3791],
        [ 0.2097, -0.0995,  0.0306,  ...,  0.2083, -0.0704,  0.1515],
        [-0.0771, -0.1223, -0.1347,  ..., -0.1598,  0.0450, -0.1815],
        ...,
        [-0.2281,  0.1514, -0.3894,  ...,  0.1887,  0.0343,  0.1685],
        [-0.0144, -0.1112, -0.2132,  ..., -0.0314, -0.0772, -0.2808],
        [-0.5981, -0.1983,  0.2279,  ..., -0.1206, -0.1876, -0.5277]],
       device='cuda:0')), ('ctx_double', tensor([[ 0.0822,  0.3007,  0.2335,  ..., -0.1626, -0.0983, -0.1346],
        [ 0.0987,  0.1217,  0.3544,  ...,  0.2639,  0.4416, -0.0209],
        [-0.2629, -0.4526,  0.1354,  ..., -0.1438,  0.1104,  0.6181],
        ...,
        [-0.1155,  0.1898,  0.2983,  ..., -0.0063, -0.0245,  0.3812],
        [-0.2163, -0.1730,  0.4958,  ...,  0.1073, -0.1771,  0.2642],
        [-0.1284, -0.1599, -0.1024,  ..., -0.0448,  0.2034,  0.1149]],
       device='cuda:0')), ('temperature', tensor(3., device='cuda:0')), ('spatial_T', tensor(3., device='cuda:0')), ('ranking_scale', tensor(4., device='cuda:0')), ('token_suffix_nocls', tensor([[[ 1.7250e-04, -8.9111e-03, -4.9591e-03,  ..., -1.8559e-03,
           1.6320e-04,  1.6680e-03],
         [-3.5915e-03, -6.1417e-03, -1.7891e-03,  ..., -8.2245e-03,
          -5.1758e-01, -4.4656e-04],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         ...,
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02]],

        [[ 1.7250e-04, -8.9111e-03, -4.9591e-03,  ..., -1.8559e-03,
           1.6320e-04,  1.6680e-03],
         [-3.5915e-03, -6.1417e-03, -1.7891e-03,  ..., -8.2245e-03,
          -5.1758e-01, -4.4656e-04],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         ...,
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02]],

        [[ 1.7250e-04, -8.9111e-03, -4.9591e-03,  ..., -1.8559e-03,
           1.6320e-04,  1.6680e-03],
         [-3.5915e-03, -6.1417e-03, -1.7891e-03,  ..., -8.2245e-03,
          -5.1758e-01, -4.4656e-04],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         ...,
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02]],

        ...,

        [[ 1.7250e-04, -8.9111e-03, -4.9591e-03,  ..., -1.8559e-03,
           1.6320e-04,  1.6680e-03],
         [-3.5915e-03, -6.1417e-03, -1.7891e-03,  ..., -8.2245e-03,
          -5.1758e-01, -4.4656e-04],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         ...,
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02]],

        [[ 1.7250e-04, -8.9111e-03, -4.9591e-03,  ..., -1.8559e-03,
           1.6320e-04,  1.6680e-03],
         [-3.5915e-03, -6.1417e-03, -1.7891e-03,  ..., -8.2245e-03,
          -5.1758e-01, -4.4656e-04],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         ...,
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02]],

        [[ 1.7250e-04, -8.9111e-03, -4.9591e-03,  ..., -1.8559e-03,
           1.6320e-04,  1.6680e-03],
         [-3.5915e-03, -6.1417e-03, -1.7891e-03,  ..., -8.2245e-03,
          -5.1758e-01, -4.4656e-04],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         ...,
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02],
         [-3.4882e-02, -4.3182e-03, -1.0056e-02,  ...,  1.0078e-02,
           7.0038e-03, -2.5925e-02]]], device='cuda:0'))])
Do evaluation on test set
mAP score default: 46.17885298200727
mAP score aux: 34.562527767112776
mAP score merged : preds + preds_aux: 47.35969855361176
mAP score: 47.35969855361176
Elapsed: 0:21:45
